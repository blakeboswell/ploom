---
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# ploom

[![lifecycle](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![CRAN_Status_Badge](https://www.r-pkg.org/badges/version/ploom)](https://cran.r-project.org/package=ploom)
[![Build Status](https://api.travis-ci.com/blakeboswell/ploom.svg?branch=develop)](https://api.travis-ci.com/blakeboswell/ploom)
[![Coverage status](https://codecov.io/gh/blakeboswell/ploom/branch/develop/graph/badge.svg)](https://codecov.io/github/blakeboswell/ploom?branch=develop)

<!-- [AppVeyor Build Status]() -->
<!-- [Coverage Status]() -->

## Overview

__Out-of-memory__ and __memory efficient__ linear model fitting with support for Inference.

## Features

- Out-of-memory processing capable of fitting __billions+__ of observations 
- Fit statistics necessary for inferential analysis
- In-memory runtime comparable to `lm()` and `glm()` with a fraction of the memory footprint
- Functions for streaming data from a Database, file connection, or in-memory source

## Installation

```{r, eval = FALSE, message=FALSE}
# development version from GitHub:
# install.packages("devtools")
devtools::install_github("blakeboswell/ploom")
```

## Usage

```{r, eval = TRUE, message=FALSE}
library(ploom)

# `oomlm()` for fitting linear models
x <- oomlm(mpg ~ cyl + disp, data = mtcars)

# `oomglm()` models fit via IRLS
z <- oomglm(mpg ~ cyl + disp)
z <- iter_weight(z, data = mtcars)

# analyze fit statistics with familiar methods
tidy(z)

# create residuals via second pass over the data
pred <- predict(z, mtcars, se_fit = TRUE)
sum((pred$fit - mtcars[, c("mpg")])^2)

# chunk in-memory `tibbles()` with `oomdata_tbl()`
chunks  <- oomdata_tbl(mtcars, chunk_size = 1)

# `oomlm()` and `oomglm()` will automatically exhaust an `oomdata` stream
x <- oomlm(mpg ~ cyl + disp, data = chunks)
z <- iter_weight(oomglm(mpg ~ cyl + disp), data = chunks)

```

Out-of-memory model fitting for data in a Database or on disk.

```{r, eval=FALSE, message=FALSE}
library(RPostgres)

con    <- dbConnect(drv = Postgres(), dbname = "mtcars")
query  <- "select mpg, cyl, disp from mtcars;"
rs     <- dbSendQuery(con, query)

chunks <- oomdata_dbi(rs, chunk_size = 4)
y <- iter_weight(oomglm(mpg ~ cyl + disp), data = chunks)
```

## Alternatives

- [`biglm`](https://cran.r-project.org/web/packages/biglm/index.html)
- [`speedglm`](https://cran.r-project.org/web/packages/speedglm/index.html)

## Acknowledgements

Thanks to:

- Fitting is performed via Alan Millerâ€™s AS274 updating QR factorization algorithm
- [`biglm`](https://cran.r-project.org/web/packages/biglm/index.html)

