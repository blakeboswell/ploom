<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Out-of-memory and memory efficient Linear Model fitting with support for Inference â€¢ ploom</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<meta property="og:title" content="Out-of-memory and memory efficient Linear Model fitting with support for Inference">
<meta property="og:description" content="A collection of tools for out-of-memory linear model fitting and
    inference. Implements `lm` and `glm` analogs using Alan Miller's AS274
    updating QR factorization algorithm. Collects and reports an array of
    pertinent fit statistics. Provides flexible and easy to use mechanisms
    to stream in data and stream out results during fitting.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ploom</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/oomlm.html">Linear Model</a>
    </li>
    <li>
      <a href="articles/oomlm.html">Generalized Linear Model</a>
    </li>
  </ul>
</li>
<li>
  <a href="articles/benchmark.html">Benchmark</a>
</li>
<li>
  <a href="https://github.com/blakeboswell/ploom">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="ploom" class="section level1">


<!-- [AppVeyor Build Status]() -->
</div>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>ploom provides tools for <em>fast</em> and <strong>memory efficient</strong> fitting of Linear and Generalized Linear models.</p>
<p>Features of ploom include:</p>
<ul>
<li>Out-of-memory processing capable of fitting <strong>billions</strong> of observations.</li>
<li>
<em>Fast</em> in-memory processing requiring less resources than <code><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm()</a></code> and <code><a href="https://www.rdocumentation.org/packages/stats/topics/glm">glm()</a></code>.</li>
<li>Compatible with <code><a href="https://www.rdocumentation.org/packages/generics/topics/tidy">tidy()</a></code>, <code><a href="https://www.rdocumentation.org/packages/generics/topics/glance">glance()</a></code>, <code><a href="https://www.rdocumentation.org/packages/generics/topics/augment">augment()</a></code> and many stats functions such as <code><a href="reference/predict.html">predict()</a></code> and <code><a href="reference/residuals.html">residuals()</a></code>.</li>
<li>Provides functions for iteratively processing data stored in-memory, in a database or on disk.</li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># development version from GitHub:</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"blakeboswell/ploom"</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Models are intialized with a <code>formula</code>; fit to data with calls to <code><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit()</a></code>; and summarized with standard functions such as <code><a href="https://www.rdocumentation.org/packages/generics/topics/tidy">tidy()</a></code>, <code><a href="https://www.rdocumentation.org/packages/generics/topics/glance">glance()</a></code>, and <code><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ploom)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="kw"><a href="reference/oomlm.html">oomlm</a></span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>qsec <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(am))</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit</a></span>(y, <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/generics/topics/tidy">tidy</a></span>(y)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 7
##   term        estimate std.error statistic    p.value conf.low conf.high
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)     9.62     6.96       1.38 0.178       -4.64       23.9 
## 2 wt             -3.92     0.711     -5.51 0.00000695  -5.37       -2.46
## 3 qsec            1.23     0.289      4.25 0.000216     0.635       1.82
## 4 factor(am)1     2.94     1.41       2.08 0.0467       0.0457      5.83</code></pre>
<div id="bounded-memory" class="section level3">
<h3 class="hasAnchor">
<a href="#bounded-memory" class="anchor"></a>Bounded Memory</h3>
<p>Models can be be fit with repeated calls to <code><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit()</a></code> over chunks of data. Each call to <code><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit()</a></code> only needs to allocate memory for the provided chunk, thereby bounding the required memory.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># create model</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw"><a href="reference/oomlm.html">oomlm</a></span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>qsec <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(am))</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co"># fit data in two chunks</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit</a></span>(y, mtcars[<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>, ])</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit</a></span>(y, mtcars[<span class="dv">17</span><span class="op">:</span><span class="dv">32</span>, ])</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(y)</a></code></pre></div>
<pre><code>## (Intercept)          wt        qsec factor(am)1 
##    9.617781   -3.916504    1.225886    2.935837</code></pre>
</div>
<div id="iterative-fitting" class="section level3">
<h3 class="hasAnchor">
<a href="#iterative-fitting" class="anchor"></a>Iterative Fitting</h3>
<p>The function <code><a href="reference/oomdata_dbi.html">oomdata_tbl()</a></code> enables iteration over an in-memory <code>tibble</code>. When an <code><a href="reference/oomdata_dbi.html">oomdata_tbl()</a></code> is provided as the data argument to <code><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit()</a></code>, all chunks are automatically iterated over.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">chunks &lt;-<span class="st"> </span><span class="kw"><a href="reference/oomdata_dbi.html">oomdata_tbl</a></span>(mtcars, <span class="dt">chunk_size =</span> <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit</a></span>(<span class="kw"><a href="reference/oomlm.html">oomlm</a></span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>qsec <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(am)), chunks)</a></code></pre></div>
<pre><code>## 
## Call:  oomlm(mpg ~ wt + qsec + factor(am))
## 
## Coefficients:
## (Intercept)           wt         qsec  factor(am)1  
##       9.618       -3.917        1.226        2.936  
## 
## Observations included:  32</code></pre>
</div>
<div id="working-with-databases" class="section level3">
<h3 class="hasAnchor">
<a href="#working-with-databases" class="anchor"></a>Working with Databases</h3>
<p>The function <code><a href="reference/oomdata_dbi.html">oomdata_dbi()</a></code> enables iteratation over a <a href=""><code>DBI</code></a> result set. <code><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit()</a></code> will automatically fit the model over all chunks.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># connect to database</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">con    &lt;-<span class="st"> </span>DBI<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DBI/topics/dbConnect">dbConnect</a></span>(RPostgres<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RPostgres/topics/Postgres">Postgres</a></span>(), <span class="dt">dbname=</span><span class="st">"mtcars"</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">result &lt;-<span class="st"> </span>DBI<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/DBI/topics/dbSendQuery">dbSendQuery</a></span>(con, <span class="st">"select mpg, wt, qsec, am from mtcars;"</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">chunks &lt;-<span class="st"> </span><span class="kw"><a href="reference/oomdata_dbi.html">oomdata_dbi</a></span>(result, <span class="dt">chunk_size =</span> <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co"># fit model to all chunks</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/generics/topics/fit">fit</a></span>(<span class="kw"><a href="reference/oomlm.html">oomlm</a></span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>qsec <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(am)), chunks)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co"># inspect fit statistiscs</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="kw"><a href="https://www.rdocumentation.org/packages/generics/topics/glance">glance</a></span>(y)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 10
##   r.squared adj.r.squared sigma statistic  p.value logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.850         0.834  2.46      52.7 1.21e-11  -72.1  154.  161.
## # â€¦ with 2 more variables: deviance &lt;dbl&gt;, df.residual &lt;dbl&gt;</code></pre>
<p>See the articles <a href="">NA</a> and <a href="">NA</a> for more on interfacing with databases.</p>
</div>
<div id="prediction-residuals" class="section level3">
<h3 class="hasAnchor">
<a href="#prediction-residuals" class="anchor"></a>Prediction &amp; Residuals</h3>
<p>Prediction with ploom models is performed with the <code><a href="reference/predict.html">predict()</a></code> function. Because ploom models do not store any data while fitting, we must also provide data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="reference/predict.html">predict</a></span>(y, <span class="dt">new_data =</span> mtcars, <span class="dt">std_error =</span> <span class="ot">TRUE</span>, <span class="dt">interval =</span> <span class="st">"prediction"</span>)</a></code></pre></div>
<pre><code>## # A tibble: 32 x 4
##    .pred .std_error .pred_lower .pred_upper
##    &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
##  1  22.5      0.720       17.2         27.7
##  2  22.2      0.744       16.9         27.4
##  3  26.3      0.760       21.0         31.6
##  4  20.9      0.685       15.6         26.1
##  5  17.0      0.749       11.7         22.3
##  6  20.9      0.768       15.6         26.1
##  7  15.1      0.942        9.66        20.4
##  8  21.6      0.747       16.4         26.9
##  9  25.4      1.34        19.6         31.1
## 10  18.6      0.605       13.4         23.8
## # â€¦ with 22 more rows</code></pre>
<p>Similarly, residuals are accessible on demand with <code><a href="reference/residuals.html">residuals()</a></code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(<span class="kw"><a href="reference/residuals.html">residuals</a></span>(y, <span class="dt">data =</span> mtcars)<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 169.2859</code></pre>
</div>
</div>
<div id="alternatives" class="section level2">
<h2 class="hasAnchor">
<a href="#alternatives" class="anchor"></a>Alternatives</h2>
<ul>
<li><a href="https://cran.r-project.org/web/packages/biglm/index.html"><code>biglm</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/speedglm/index.html"><code>speedglm</code></a></li>
</ul>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>Thanks to:</p>
<ul>
<li>Fitting is performed via Alan Millerâ€™s AS274 updating QR factorization algorithm</li>
<li><a href="https://cran.r-project.org/web/packages/biglm/index.html"><code>biglm</code></a></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://github.com/bboswell/ploom/issues">https://â€‹github.com/â€‹bboswell/â€‹ploom/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/blakeboswell">Blake Boswell</a> <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=ploom"><img src="https://www.r-pkg.org/badges/version/ploom" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://api.travis-ci.com/blakeboswell/ploom"><img src="https://api.travis-ci.com/blakeboswell/ploom.svg?branch=develop" alt="Build Status"></a></li>
<li><a href="https://codecov.io/github/blakeboswell/ploom?branch=develop"><img src="https://codecov.io/gh/blakeboswell/ploom/branch/develop/graph/badge.svg" alt="Coverage status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="lifecycle"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/blakeboswell">Blake Boswell</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
